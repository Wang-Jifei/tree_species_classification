## Tree species classification project

### Environment setting

R, Python 3.6 +

Required R packages: lidR, rasters

Required python packages: 

- "laspy", "numpy", "datetime", and "PIL".
- "opencv-python", "gdal", "geopandas", "matplotlib", "mpl_toolkits", "ogr", "pandas", "scipy", "scikitplot", "sklearn", "skimage", "time"

**Data source:** 3D point cloud data (.las), Multi-spectral images (.tif)

**Intermediate results** (generated by software): Canopy height model (chm.tif), MRS segmentation image (mrs_seg{}.tif), stacked feature image (features.tif)

**Final results:** Tree species classification map (classification.tif) 



### KNN-based CHM generation

KNN/chm_knn.py

There are four parts in this python file: 

1. Read point cloud file and view the basic information of it.
2. Reduce 3D point cloud data to 2D raster.
3. Interpolate point cloud data.
4. Calculate height's metrics.

The input file used in this python code is "off-ground points.las". Before running this code file, please set your own input file path and output file path in Line 11 and Line 14.

The python packages used in this code file are "laspy", "numpy", "datetime", and "PIL". For those packages your python hasn't install, please use "pip install packages" in your command window to install them.



###  Watershed segmentation

Watershed/watershe.ipynb

**Input:** canopy height model (chm.tif)

**Output:** treetops location; watershed segmentation image



### GLCM features generation

GLCM/GLCM_texture.ipynb

**Input:** Multi-spectral image tree.tif (4 bands)

**Output:** 11 texture features calculated for R, G, B band, respectively.



### Object-based tree classification

Object-based classification.ipynb

#### Implementation steps:

##### Read image segmentation

##### Object-based feature extraction

###### 1. Function segment_features(segment_pixels)

**Input:** segmented object (2D array)

**Output:** object features (1D vector)

###### 2. Save Object-based feature to csv

###### 3. Visualization of object-based features

##### Training RF/SVM classifier

###### 1. Prepare training groud truth points

###### 2. Prepare training objects

###### 3. Train RF classifier

**Input:** training data, training label

**Output:** predicted labels

###### 4. Save RF classified results

###### 5. Assessment of classification accuracy



#### Pixel-based feature analysis 

pixel-based analysis.ipynb

**Input:**

Feature image (44 bands) : r"data/features.tif"

Labeled ground truth (7 classes): r"data/label.tif"

**Output:**

Visualization plots of pixel density for each feature band